import{q as E,r as l,b as m,j as e,a as C}from"./app--yM69B3u.js";import{A as S}from"./AuthenticatedLayout-C1S-0GyU.js";import{b as h}from"./Api-Rb4oq7BM.js";import{B as _}from"./BootstrapToaster-3hnoYUoa.js";import"./index-CW7j9gvC.js";function $({auth:N}){var b,g;const p=E().props,c=(b=p.role)==null?void 0:b.id,[x,v]=l.useState([]),[u,f]=l.useState([]),[o,j]=l.useState({type:"",message:"",title:""});l.useEffect(()=>{c&&(y(),w())},[c]);const y=async()=>{let a=[],s=1,t=1;try{for(;s<=t;){const r=await m.get(`http://16.171.64.154/api/admin/permissions?page=${s}`,h),n=r.data.data;a=[...a,...n],s++,t=r.data.meta.last_page}const i=a.reduce((r,n)=>{const d=n.name.split(" ")[1];return r[d]||(r[d]=[]),r[d].push(n),r},{});v(i)}catch(i){console.error("Error fetching all permissions:",i)}},w=async()=>{try{const s=(await m.get(`http://16.171.64.154/api/admin/addPermissionToRole/${c}`,h)).data.rolePermissionsNames;f(Object.values(s).map(t=>t.toString()))}catch(a){console.error("Error fetching role permissions:",a)}},P=a=>{const s=a.target.value;f(t=>t.includes(s)?t.filter(i=>i!==s):[...t,s])},k=async a=>{a.preventDefault();try{const s=await m.post(`http://16.171.64.154/api/admin/givePermissionToRole/${c}`,{permission:u},h);s.status===201?j({type:"success",message:"success.",title:"Success"}):j({type:"error",message:s.data.message,title:"error"}),alert("permission_web_webs updated successfully!")}catch(s){console.error("Error updating permissions:",s)}};return e.jsx(S,{user:N.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Give Permissions"}),children:e.jsx("div",{className:"container mt-5",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h4",{className:"",children:["Role: ",(g=p.role)==null?void 0:g.name]})}),e.jsx("div",{className:"col-sm-12",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("form",{onSubmit:k,children:[Object.keys(x).map(a=>e.jsx("div",{className:"col-xxl-4 col-md-6",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"card-header border-l-primary border-3 card-no-border pb-0 card height-equal",children:[e.jsx("h5",{className:"",children:a.charAt(0).toUpperCase()+a.slice(1)}),e.jsx("div",{className:"",children:x[a].map(s=>e.jsx("div",{className:"",children:e.jsx("div",{className:"form-check form-switch form-check-inline",children:e.jsxs("label",{className:"d-flex",children:[e.jsx("input",{type:"checkbox",role:"switch",value:s.name,checked:u.includes(s.name),onChange:P,className:"form-check-input switch-primary check-size "}),s.name.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase())]})})},s.id))})]})},a)})),e.jsxs("div",{className:"card-body btn-showcase",children:[e.jsx("button",{type:"submit",className:"btn btn-primary d-flex  ms-2",children:"Update"}),e.jsx(C,{href:route("role_web_webs.index"),className:"btn btn-info",children:"Cancel"})]})]}),o.message&&e.jsx(_,{type:o.type,message:o.message,title:o.title})]})})})]})})})})})}export{$ as default};
