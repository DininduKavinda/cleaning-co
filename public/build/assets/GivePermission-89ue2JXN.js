import{q as E,r as l,b as m,j as e,a as C}from"./app-BGrlIOB8.js";import{A as S}from"./AuthenticatedLayout-X6LyfNqf.js";import{b as h}from"./Api-_485fmwb.js";import{B as R}from"./BootstrapToaster-Z7gsQhx8.js";import"./index-Blqs8vea.js";function $({auth:N}){var g,b;const p=E().props,i=(g=p.role)==null?void 0:g.id,[x,v]=l.useState([]),[u,f]=l.useState([]),[o,j]=l.useState({type:"",message:"",title:""});l.useEffect(()=>{i&&(y(),P())},[i]);const y=async()=>{let a=[],s=1,t=1;try{for(;s<=t;){const r=await m.get(`https://cleaning-co.test/api/admin/permissions?page=${s}`,h),n=r.data.data;a=[...a,...n],s++,t=r.data.meta.last_page}const c=a.reduce((r,n)=>{const d=n.name.split(" ")[1];return r[d]||(r[d]=[]),r[d].push(n),r},{});v(c)}catch(c){console.error("Error fetching all permissions:",c)}},P=async()=>{try{const s=(await m.get(`https://cleaning-co.test/api/admin/addPermissionToRole/${i}`,h)).data.rolePermissionsNames;f(Object.values(s).map(t=>t.toString()))}catch(a){console.error("Error fetching role permissions:",a)}},k=a=>{const s=a.target.value;f(t=>t.includes(s)?t.filter(c=>c!==s):[...t,s])},w=async a=>{a.preventDefault();try{const s=await m.post(`https://cleaning-co.test/api/admin/givePermissionToRole/${i}`,{permission:u},h);s.status===201?j({type:"success",message:"success.",title:"Success"}):j({type:"error",message:s.data.message,title:"error"}),alert("Permissions updated successfully!")}catch(s){console.error("Error updating permissions:",s)}};return e.jsx(S,{user:N.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Give Permissions"}),children:e.jsx("div",{className:"container mt-5",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h4",{className:"",children:["Role: ",(b=p.role)==null?void 0:b.name]})}),e.jsx("div",{className:"col-sm-12",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("form",{onSubmit:w,children:[Object.keys(x).map(a=>e.jsx("div",{className:"col-xxl-4 col-md-6",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"card-header border-l-primary border-3 card-no-border pb-0 card height-equal",children:[e.jsx("h5",{className:"",children:a.charAt(0).toUpperCase()+a.slice(1)}),e.jsx("div",{className:"",children:x[a].map(s=>e.jsx("div",{className:"",children:e.jsx("div",{className:"form-check form-switch form-check-inline",children:e.jsxs("label",{className:"d-flex",children:[e.jsx("input",{type:"checkbox",role:"switch",value:s.name,checked:u.includes(s.name),onChange:k,className:"form-check-input switch-primary check-size "}),s.name.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase())]})})},s.id))})]})},a)})),e.jsxs("div",{className:"card-body btn-showcase",children:[e.jsx("button",{type:"submit",className:"btn btn-primary d-flex  ms-2",children:"Update"}),e.jsx(C,{href:route("roles.index"),className:"btn btn-info",children:"Cancel"})]})]}),o.message&&e.jsx(R,{type:o.type,message:o.message,title:o.title})]})})})]})})})})})}export{$ as default};
