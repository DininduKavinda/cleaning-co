import{r as l,j as e,b as I,a as z}from"./app-BGrlIOB8.js";import{g as F}from"./TaskApi-D-Mta_6K.js";import{S as w}from"./react-select.esm-DzUBhU4r.js";import{g as H,s as M}from"./StaffApi-CwMbBldO.js";import"./Api-_485fmwb.js";import"./floating-ui.dom-DtcZXcvp.js";localStorage.getItem("authToken");function P({value:o,onChange:p}){const[u,r]=l.useState([]),[v,c]=l.useState(!0);return l.useEffect(()=>{(async()=>{try{const d=await F();r(d.data.data),c(!1)}catch(d){console.error("Error fetching tasks:",d),c(!1)}})()},[]),e.jsxs("select",{className:"form-control",value:o,name:"task_id",onChange:i=>p(i.target.value),disabled:v,children:[e.jsx("option",{value:"",children:"Select Task"}),u.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})}const G=({clientId:o,setClientId:p})=>{const[u,r]=l.useState([]),[v,c]=l.useState(!1),d={headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}};l.useEffect(()=>{o&&N(o)},[o]);const S=async s=>{c(!0);try{const g=(await I.get(`https://cleaning-co.test/api/web/clients?full_name[like]=${s}`,d)).data.data.map(f=>({value:f.id,label:f.full_name}));r(f=>[...f,...g.filter(C=>f.every(k=>k.value!==C.value))])}catch(h){console.error("Error fetching clients:",h)}finally{c(!1)}},N=async s=>{c(!0);try{const g=(await I.get(`https://cleaning-co.test/api/web/clients/${s}`,d)).data.data,f={value:g.id,label:g.full_name};r(j=>j.some(C=>C.value===g.id)?j:[...j,f])}catch(h){console.error("Error fetching initial client:",h)}finally{c(!1)}},n=s=>{s?S(s):r([])},m=s=>{p(s?s.value:null)};return e.jsx(w,{placeholder:"Select Client",value:u.find(s=>s.value===o)||null,isLoading:v,onInputChange:n,options:u,onChange:m,isClearable:!0,cacheOptions:!0})},E=({staffId:o,setStaffId:p})=>{const[u,r]=l.useState([]),[v,c]=l.useState(!1);localStorage.getItem("authToken"),l.useEffect(()=>{o&&d(o)},[o]);const i=async n=>{c(!0);try{const s=M({"full_name[like]":n}).data.data.map(h=>({value:h.id,label:h.full_name}));r(s)}catch(m){console.error("Error fetching staffs:",m)}finally{c(!1)}},d=async n=>{c(!0);try{const s=(await H(n)).data.data;r([{value:s.id,label:s.full_name}])}catch(m){console.error("Error fetching initial staff:",m)}finally{c(!1)}},S=n=>{n?i(n):r([])},N=n=>{p(n?n.value:null)};return e.jsx(w,{placeholder:"Select Staff",value:u.find(n=>n.value===o)||null,isLoading:v,onInputChange:S,options:u,onChange:N,isClearable:!0,cacheOptions:!0})};function Z({onSearch:o,onActiveSearch:p,onTaskSearch:u,onClientSearch:r,onApproved_bySearch:v,onStaffSearch:c,onDepartmentSearch:i,onCodeSearch:d,onStartedAtSearch:S,onEndedAtSearch:N,onStatusSearch:n}){const[m,s]=l.useState(""),[h,g]=l.useState(""),[f,j]=l.useState(""),[C,k]=l.useState(""),[A,T]=l.useState(""),[b,D]=l.useState(""),[x,L]=l.useState({task_id:null,client_id:null,staff_id:null,approved_by_id:null,department_id:null}),$=t=>{const a=t.target.value;s(a),o(a)},O=t=>{const a=t.target.value;g(a),d(a)},B=t=>{const a=t.target.value;j(a),S(a)},K=t=>{const a=t.target.value;k(a),N(a)},R=t=>{const a=t.target.value;T(a),n(a)},y=t=>{const a=t.target.value;D(a),p(a)},_=(t,a)=>{switch(L(q=>({...q,[t]:a})),t){case"task_id":u(a);break;case"client_id":r(a);break;case"staff_id":c(a);break;case"approved_by":v(a);break;case"department_id":i(a);break}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-md-12 project-list",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("ul",{className:"nav nav-tabs border-tab",id:"top-tab",role:"tablist",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:`nav-link ${b===""?"active":""}`,id:"top-home-tab","data-bs-toggle":"tab",href:"#top-home",role:"tab","aria-controls":"top-home","aria-selected":b==="",onClick:()=>y({target:{value:""}}),children:[e.jsx("i",{"data-feather":"target"}),"All"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:`nav-link ${b==="1"?"active":""}`,id:"profile-top-tab","data-bs-toggle":"tab",href:"#top-profile",role:"tab","aria-controls":"top-profile","aria-selected":b==="1",onClick:()=>y({target:{value:"1"}}),children:[e.jsx("i",{"data-feather":"info"}),"Active"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:`nav-link ${b==="0"?"active":""}`,id:"contact-top-tab","data-bs-toggle":"tab",href:"#top-contact",role:"tab","aria-controls":"top-contact","aria-selected":b==="0",onClick:()=>y({target:{value:"0"}}),children:[e.jsx("i",{"data-feather":"check-circle"}),"Inactive"]})})]})}),e.jsxs("div",{className:"col-md-6 d-md-block d-none",children:[e.jsx("div",{className:"form-group mb-0 me-0"}),e.jsxs(z,{className:"btn btn-primary d-flex align-items-center",href:route("matters.create"),children:[" ",e.jsx("i",{"data-feather":"plus-square"}),"Create New"," "]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6  mt-3",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by name...",value:m,onChange:$})]}),e.jsxs("div",{className:"col-md-6  mt-3",children:[e.jsx("label",{children:"Code"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by code...",value:h,onChange:O})]}),e.jsxs("div",{className:"col-md-3 mt-3",children:[e.jsx("label",{children:"Start Date"}),e.jsx("input",{type:"date",className:"form-control",value:f,onChange:B})]}),e.jsxs("div",{className:"col-md-3 mt-3",children:[e.jsx("label",{children:"End Date"}),e.jsx("input",{type:"date",className:"form-control",value:C,onChange:K})]}),e.jsxs("div",{className:"col-md-3 mt-3",children:[e.jsx("label",{children:"Task"}),e.jsx(P,{taskId:x.task_id,setTaskId:t=>_("task_id",t)})]}),e.jsxs("div",{className:"col-md-3 mt-3",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:A,onChange:R,children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"1",children:"Approved"}),e.jsx("option",{value:"2",children:"Declined"}),e.jsx("option",{value:"2",children:"Pending"}),e.jsx("option",{value:"2",children:"New"})]})]}),e.jsxs("div",{className:"col-md-4 mt-3",children:[e.jsx("label",{children:"Client"}),e.jsx(G,{taskId:x.task_id,clientId:x.client_id,setClientId:t=>_("client_id",t)})]}),e.jsxs("div",{className:"col-md-4 mt-3",children:[e.jsx("label",{children:"Staff"}),e.jsx(E,{clientId:x.client_id,staffId:x.staff_id,setStaffId:t=>_("staff_id",t)})]}),e.jsxs("div",{className:"col-md-4 mt-3",children:[e.jsx("label",{children:"Approved_by"}),e.jsx(E,{staffId:x.staff_id,approved_byId:x.approved_by_id,setApproved_byId:t=>_("approved_by_id",t)})]})]})})]})})})}export{Z as default};
